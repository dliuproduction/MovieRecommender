<p> testing </p>
<script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>

<script src="//www.WebRTC-Experiment.com/RecordRTC.js"></script>
<script src="https://cdn.binaryjs.com/0/binary.js"></script>

<script type="text/javascript">
	var session = {
  audio: true,
  video: false
};
var recordRTC = null;
navigator.getUserMedia(session, function (mediaStream) {
  recordRTC = RecordRTC(MediaStream);
  recordRTC.startRecording();
}, onError);
recordRTC.stopRecording(function(audioURL) {
  var formData = new FormData();
  formData.append('edition[audio]', recordRTC.getBlob())
  $.ajax({
    type: 'POST',
    url: 'some/path',
    data: formData,
    contentType: false,
    cache: false,
    processData: false,
  })
});


var client = new BinaryClient('ws://localhost:9001');
client.on('open', function() {
  // for the sake of this example let's put the stream in the window
  window.Stream = client.createStream();
}

function convertFloat32ToInt16(buffer) {
  l = buffer.length;
  buf = new Int16Array(l);
  while (l--) {
    buf[l] = Math.min(1, buffer[l])*0x7FFF;
  }
  return buf.buffer;
}

function recorderProcess(e) {
  var left = e.inputBuffer.getChannelData(0);
  window.Stream.write(convertFloat32ToInt16(left));
}
</script>